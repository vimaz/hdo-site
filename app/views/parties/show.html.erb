<% title "#{@party.name} - #{t('app.title')}" %>
<h2 class="party-title-name">
  <%= image_tag @party.image_with_fallback.thumb("96x96").url, alt: "#{@party.name}s logo" %>
  <%= @party.name %>
</h2>

<div id="representatives" class="swiper-container">
  <div class="swiper-wrapper">
  <% @representatives.each_slice(1).with_index do |representative_group, index| %>
    <% representative_group.each do |representative| %>
      <div class="swiper-slide representative" style='background-image:url("<%= path_to_image representative.image_with_fallback.thumb('140x180#').strip.url %>")'>
        <%= link_to(representative) do %>
          <%= representative.full_name %>
        <% end %>
      </div>
    <% end %>
  <% end %>
  </div>
</div>

<hr>

<% content_for :document_ready do %>
  <script>
    window.onload = function() {
      var mySwiper = new Swiper('.swiper-container', {'slidesPerSlide': 7});
    }
  </script>
<% end %>


<div class="row-fluid">
  <div class="tabbable">
    <ul class="nav nav-tabs">

      <li class="span6">
        <a href="#promises-tab" data-toggle="tab">Hva de har lovet</a>
      </li>

      <li class="active span6">
        <a href="#issues-tab" data-toggle="tab">Hva de har stemt</a>
      </li>
    </ul>

    <div class="tab-content">
      <div class="tab-pane active" id="issues-tab">
          <%= render partial: "issue_list", locals: { party: @party, :issues => @issues } %>
      </div>

      <div class="tab-pane" id="promises-tab">
        <div class="span3 categories">
          <%= render partial: 'shared/main_categories_list', locals: { categories: @categories } %>
        </div>

        <div class="span9">
          <%= render partial: 'shared/promises_results' %>
        </div>
      </div>
    </div>
  </div>
</div>

<% content_for :document_ready do %>
  <script>
    $(document).ready(function () {
      var widget = HDO.promiseWidget.create({
        targetEl: $(".promises-results"),
        categoriesSelector: $(".categories"),
        server: HDO.promiseServerFacade,
        activeParty: '<li class="<%= @party.slug %>-active"><a href="#" data-party-slug="<%= @party.slug %>"></a></li>',
        spinnerEl: $("#spinner")
      });

      widget.init();
    });
  </script>
<% end %>
